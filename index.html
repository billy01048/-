<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>체크메이트 — AI 건강 자가진단</title>
<link rel="stylesheet" href="assets/css/style.css">
<link rel="icon" type="image/png" sizes="32x32" href="assets/img/favicon-32.png">
</head>
<body>
<div class="wrap">

  <header>
    <div class="brand">
      <a href="/" aria-label="체크메이트 홈" class="brand-link">
        <img class="logo" src="assets/img/Whisk_1b04af24275649aa7eb438317b3ad964dr-removebg-preview.png"
             alt="체크메이트 로고 — AI 건강 자가진단" />
      </a>
      <div>
        <h1>AI 건강 자가진단 (텍스트)</h1>
        <div class="subtitle">증상 선택 → GPT에 붙여넣을 텍스트 자동 생성</div>
      </div>
    </div>
    <div class="muted small">본 도구는 의학적 진단을 제공하지 않습니다.</div>
  </header>

  <div class="layout">

    <!-- LEFT: 설정 -->
    <div class="card">
      <div class="section-title">1) 검사 설정</div>

      <div style="margin-bottom:10px">
        <div class="muted">검사 난이도</div>
        <div class="row" style="margin-top:8px">
          <button class="mode-btn" id="modeSimple">간단 검사</button>
          <button class="mode-btn" id="modeDeep">정밀 검사</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="muted">성별</div>
        <div class="row" style="margin-top:8px">
          <button class="gender-btn" id="maleBtn">남자</button>
          <button class="gender-btn" id="femaleBtn">여자</button>
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="muted">나이</div>
        <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
          <input type="range" id="ageRange" min="0" max="120" value="30" class="range">
          <input type="number" id="ageNum" min="0" max="120" value="30">
        </div>
      </div>

      <div style="margin-top:12px">
        <div class="muted">기저질환(선택)</div>
        <div class="row" style="margin-top:8px">
          <label><input type="checkbox" id="chronic1"> 고혈압</label>
          <label><input type="checkbox" id="chronic2"> 당뇨</label>
          <label><input type="checkbox" id="chronic3"> 심질환</label>
        </div>
      </div>

      <div style="margin-top:14px">
        <div class="section-title">선택한 증상</div>
        <div id="selectedChips" class="chips"></div>

        <div style="margin-top:10px">
          <button class="generate-btn" id="btnGenerate">GPT에 보낼 내용 만들기 (복사)</button>
          <div id="copyNote" class="copy-note">복사 완료 — GPT창에 붙여넣기 하세요.</div>
        </div>
      </div>

      <div class="ad-slot" style="margin-top:16px">광고 슬롯 (좌측 하단)</div>
    </div>

    <!-- CENTER: 증상 검색 + 리스트 -->
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div class="section-title">2) 증상 선택 (카테고리)</div>
          <div class="muted">카테고리 선택 → 아래에서 세부 증상 체크 (우클릭/롱프레스 = 자세히 보기)</div>
        </div>
        <div style="display:flex;gap:8px">
          <input id="quickSearch" class="searchbar" placeholder="증상검색 (예: 기침, 두통, 복통)" />
        </div>
      </div>

      <div class="category-row" id="categoryRow"></div>

      <div class="symptom-list" id="symptomList" tabindex="0"></div>

      <div style="margin-top:12px" class="muted">우클릭 또는 모바일 롱프레스 → 증상별 상세 설명 보기</div>
    </div>

    <!-- RIGHT: 고급 입력 & 질환 추천 -->
    <div class="card">
      <div class="section-title">3) 고급 입력 / 의심 질환(자동 추천)</div>
      <div class="muted">직접 증상 입력 또는 자동 추천된 의심 질환을 확인하세요.</div>
      <textarea id="advancedInput" placeholder="예: 2주전부터 시작한 지속적 기침, 가래에 혈이 섞임..." ></textarea>

      <div style="margin-top:12px">
        <div class="section-title">자동 추천 의심 질환</div>
        <div id="recommendedDiseases" class="chips muted small">추천 질환이 여기에 표시됩니다.</div>
      </div>

      <div style="margin-top:12px" class="section-title">광고(우측)</div>
      <div class="ad-slot">광고 슬롯 (우측)</div>
    </div>

  </div>

  <footer class="footer-muted footer">
    이 도구는 의학적 진단을 제공하지 않습니다. 긴급 상황(호흡곤란, 의식 소실, 심한 흉통 등) 시 즉시 응급실을 방문하세요.
  </footer>

</div>

<!-- 상세보기 모달 -->
<div id="detailModal" class="detail-modal" role="dialog" aria-hidden="true" aria-labelledby="detailTitle" aria-describedby="detailContent">
  <button class="close" aria-label="닫기 (모달)" title="닫기">✕</button>
  <div class="title" id="detailTitle"></div>
  <div class="content" id="detailContent"></div>
</div>

<!-- 전면 왼쪽 고정 광고 오버레이 (모든 UI 앞에 위치) -->
<div class="ad-overlay" id="global-ad-overlay" role="complementary" aria-label="광고 영역">
  <button class="ad-close" id="adCloseBtn" aria-label="광고 닫기">✕</button>
  <ins class="kakao_ad_area"
       style="display:none;"
       data-ad-unit="DAN-zaoVahGFL19x5VCC"
       data-ad-width="160"
       data-ad-height="600"></ins>
  <div class="ad-fallback-red" id="adFallback" style="display:none;">
    광고 영역 — 현재 광고가 준비되지 않았습니다.
  </div>
</div>

<!-- 카카오 광고 스크립트 (한 번만 포함) -->
<script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script>

<!-- 광고 초기화 / 닫기 / 대체 콘텐츠 처리 (빨간색 대체 박스 포함) -->
<script>
(async function setupGlobalAd(){
  const overlay = document.getElementById('global-ad-overlay');
  const ins = overlay.querySelector('.kakao_ad_area');
  const fallback = document.getElementById('adFallback');
  const closeBtn = document.getElementById('adCloseBtn');
  const STORAGE_KEY = 'globalAdClosed_v1';

  // 닫기 상태 확인
  if(localStorage.getItem(STORAGE_KEY) === '1'){
    overlay.style.display = 'none';
    return;
  }

  // ba 스크립트 보장(이미 있으면 패스)
  function ensureBa(){
    return new Promise((resolve)=>{
      const existing = Array.from(document.scripts).find(s=>s.src && s.src.includes('t1.daumcdn.net'));
      if(existing) {
        if(existing.readyState === 'complete' || existing.readyState === 'loaded') return resolve(true);
        existing.addEventListener('load', ()=>resolve(true));
        existing.addEventListener('error', ()=>resolve(false));
        return;
      }
      const s = document.createElement('script');
      s.src = "//t1.daumcdn.net/kas/static/ba.min.js";
      s.async = true;
      s.onload = ()=> resolve(true);
      s.onerror = ()=> resolve(false);
      document.head.appendChild(s);
    });
  }

  const ok = await ensureBa();
  if(ok){
    // 광고 스크립트가 있으면 ins 보이게
    ins.style.display = 'block';
  } else {
    // 로드 실패 시 빨간색 대체박스 노출
    ins.style.display = 'none';
    fallback.style.display = 'block';
  }

  // 일정 시간 후에도 광고가 실제로 렌더링되지 않으면 대체박스(red) 표시
  setTimeout(()=> {
    // 실제 광고는 iframe이나 img로 렌더링됨
    const rendered = ins.querySelectorAll('iframe, img').length > 0;
    if(!rendered){
      ins.style.display = 'none';
      fallback.style.display = 'block';
    } else {
      fallback.style.display = 'none';
    }
  }, 4500); // 4.5초 후 판단

  // 닫기 처리 (한 번 닫으면 로컬스토리지에 저장)
  closeBtn.addEventListener('click', ()=> {
    overlay.style.display = 'none';
    localStorage.setItem(STORAGE_KEY, '1');
  });

  // ESC로도 닫기
  document.addEventListener('keydown', (e)=> {
    if(e.key === 'Escape'){
      overlay.style.display = 'none';
      localStorage.setItem(STORAGE_KEY, '1');
    }
  });

})();
</script>

<script src="assets/js/app.js"></script>
</body>
</html>
